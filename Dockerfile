FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHN5bmMtYXBwLWFwYgpkZXNjcmlwdGlvbjogSW5zdGFsbHMgdGhl\
IEFlcm9nZWFyIFN5bmMgQXBwbGljYXRpb24KYmluZGFibGU6IFRydWUKYXN5bmM6IG9wdGlvbmFs\
CnRhZ3M6CiAgLSBtb2JpbGUtc2VydmljZQogIC0gbW9iaWxlLWNsaWVudC1lbmFibGVkCm1ldGFk\
YXRhOgogIGRpc3BsYXlOYW1lOiBTeW5jIEFwcAogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25D\
bGFzczogZmEgZmEtcmVmcmVzaAogICNkb2N1bWVudGF0aW9uVXJsOiAiaHR0cHM6Ly9kb2NzLmFl\
cm9nZWFyLm9yZy9hZXJvZ2Vhci9sYXRlc3QvZGF0YS1zeW5jLyIKICBwcm92aWRlckRpc3BsYXlO\
YW1lOiAiUmVkIEhhdCwgSW5jLiIKICBzZXJ2aWNlTmFtZTogc3luYy1hcHAKcGxhbnM6CiAgLSBu\
YW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBwbGFuIHNldHMgdXAgdGhlIFN5bmMg\
QXBwbGljYXRpb24KICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiAKICAgICAgbW9iaWxlY2xp\
ZW50X2JpbmRfcGFyYW1ldGVyc19kYXRhOgogICAgICAgIC0gJ3t9JwogICAgcGFyYW1ldGVyczoK\
ICAgICAgLSBuYW1lOiBTWU5DX0FQUF9OQU1FCiAgICAgICAgZGVzY3JpcHRpb246IFRoZSBuYW1l\
IG9mIHlvdXIgc3luYyBhcHBsaWNhdGlvbi4KICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBw\
YXR0ZXJuOiAiXlthLXpdW2EtejAtOS1dKlthLXowLTldJCIKICAgICAgICByZXF1aXJlZDogVHJ1\
ZQogICAgICAgIHRpdGxlOiBTeW5jIEFwcGxpY2F0aW9uIE5hbWUKICAgICAgLSBuYW1lOiBTWU5D\
X0FQUF9ET0NLRVJfSU1BR0UKICAgICAgICBkZXNjcmlwdGlvbjogVVJMIG9mIHlvdXIgR3JhcGhR\
TCBTZXJ2ZXIgRG9ja2VyIEltYWdlLCBlLmcuIGRvY2tlci5pby9hZXJvZ2Vhci92b3lhZ2VyLXNl\
cnZlci1leGFtcGxlLXRhc2sKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDog\
VHJ1ZQogICAgICAgIHRpdGxlOiBTeW5jIEFwcGxpY2F0aW9uIERvY2tlciBpbWFnZQogICAgICAt\
IG5hbWU6IFNZTkNfQVBQX0RPQ0tFUl9JTUFHRV9WRVJTSU9OCiAgICAgICAgZGVzY3JpcHRpb246\
IChkZWZhdWx0IHZhbHVlOiAnbGF0ZXN0JykgVmVyc2lvbiBvZiB5b3VyIFN5bmMgQXBwbGljYXRp\
b24gRG9ja2VyIEltYWdlCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IEZh\
bHNlCiAgICAgICAgdGl0bGU6IFN5bmMgQXBwbGljYXRpb24gRG9ja2VyIGltYWdlIHZlcnNpb24K\
ICAgICAgICBkZWZhdWx0OiAnbGF0ZXN0JwogICAgICAtIG5hbWU6IFNZTkNfQVBQX0hFQUxUSF9F\
TkRQT0lOVAogICAgICAgIGRlc2NyaXB0aW9uOiAoZGVmYXVsdCB2YWx1ZTogJycpIEhlYWx0aCBF\
bmRwb2ludCBvZiB5b3VyIFN5bmMgQXBwbGljYXRpb24uIFVzZSAnaGVhbHRoJyBmb3IgZG9ja2Vy\
LmlvL2Flcm9nZWFyL3ZveWFnZXItc2VydmVyLWV4YW1wbGUtdGFzayBpbWFnZS4KICAgICAgICB0\
eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogRmFsc2UKICAgICAgICB0aXRsZTogU3luYyBB\
cHBsaWNhdGlvbiBoZWFsdGggZW5kcG9pbnQKICAgICAgLSBuYW1lOiBTWU5DX0FQUF9NRVRSSUNT\
X0VORFBPSU5UCiAgICAgICAgZGVzY3JpcHRpb246IChkZWZhdWx0IHZhbHVlOiAnL21ldHJpY3Mn\
KSBNZXRyaWNzIGVuZHBvaW50IG9mIHlvdXIgU3luYyBBcHBsaWNhdGlvbgogICAgICAgIHR5cGU6\
IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICAgIHRpdGxlOiBTeW5jIEFwcGxp\
Y2F0aW9uIG1ldHJpY3MgZW5kcG9pbnQKICAgICAgICBkZWZhdWx0OiAnbWV0cmljcycKICAgICAg\
LSBuYW1lOiBTWU5DX0FQUF9QT1JUCiAgICAgICAgZGVzY3JpcHRpb246IFBvcnQgb2YgdGhlIFN5\
bmMgQXBwbGljYXRpb24gdG8gRXhwb3NlLiBVc2UgJzQwMDAnIGZvciBkb2NrZXIuaW8vYWVyb2dl\
YXIvdm95YWdlci1zZXJ2ZXItZXhhbXBsZS10YXNrIGltYWdlLgogICAgICAgIHR5cGU6IG51bWJl\
cgogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IFN5bmMgQXBwIFBvcnQKICAg\
ICAgLSBuYW1lOiBTWU5DX0FQUF9HUkFQSFFMX0VORFBPSU5UCiAgICAgICAgZGVzY3JpcHRpb246\
IChkZWZhdWx0IHZhbHVlOiAnZ3JhcGhxbCcpIEdyYXBoUUwgRW5kcG9pbnQgb2YgeW91ciBTeW5j\
IEFwcGxpY2F0aW9uIAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBGYWxz\
ZQogICAgICAgIHRpdGxlOiBTeW5jIEFwcCBHcmFwaFFMIEVuZHBvaW50CiAgICAgIC0gbmFtZTog\
REJfSE9TVE5BTUUKICAgICAgICBkZXNjcmlwdGlvbjogSG9zdG5hbWUgb2YgdGhlIERhdGFiYXNl\
IFNlcnZlcgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAg\
ICAgdGl0bGU6IERhdGFiYXNlIFNlcnZlciBIb3N0bmFtZQogICAgICAtIG5hbWU6IERCX1BPUlQK\
ICAgICAgICBkZXNjcmlwdGlvbjogUG9ydCBvZiB0aGUgRGF0YWJhc2UgU2VydmVyCiAgICAgICAg\
dHlwZTogbnVtYmVyCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICB0aXRsZTogRGF0YWJh\
c2UgU2VydmVyIFBvcnQKICAgICAgLSBuYW1lOiBEQl9VU0VSTkFNRQogICAgICAgIGRlc2NyaXB0\
aW9uOiBVc2VybmFtZSB0aGF0IHdpbGwgYmUgdXNlZCB0byBjb25uZWN0IHRvIERhdGFiYXNlCiAg\
ICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICB0aXRsZTog\
RGF0YWJhc2UgU2VydmVyIFVzZXJuYW1lCiAgICAgIC0gbmFtZTogREJfUEFTU1dPUkQKICAgICAg\
ICBkZXNjcmlwdGlvbjogUGFzc3dvcmQgdGhhdCB3aWxsIGJlIHVzZWQgdG8gY29ubmVjdCB0byBE\
YXRhYmFzZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAg\
ICAgdGl0bGU6IERhdGFiYXNlIFNlcnZlciBQYXNzd29yZAogICAgICAtIG5hbWU6IERCX05BTUUK\
ICAgICAgICBkZXNjcmlwdGlvbjogTmFtZSBvZiB0aGUgRGF0YWJhc2UKICAgICAgICB0eXBlOiBz\
dHJpbmcKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIHRpdGxlOiBEYXRhYmFzZSBuYW1l\
CiAgICAgIC0gbmFtZTogREJfU1NMCiAgICAgICAgZGVzY3JpcHRpb246IFVzZSBTU0wgY29ubmVj\
dGlvbiB0byB0aGUgRGF0YWJhc2UgU2VydmVyCiAgICAgICAgdHlwZTogYm9vbGVhbgogICAgICAg\
IGRpc3BsYXlfdHlwZTogY2hlY2tib3gKICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAgICAgIHRp\
dGxlOiBVc2UgU1NMPwogICAgYmluZF9wYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IENMSUVOVF9J\
RAogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IE1vYmlsZSBDbGllbnQgSUQK\
ICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICAK"

COPY playbooks /opt/apb/project
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
