FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHN5bmMtYXBwLWFwYgpkZXNjcmlwdGlvbjogSW5zdGFsbHMgdGhl\
IEFlcm9nZWFyIFN5bmMgQXBwbGljYXRpb24KYmluZGFibGU6IFRydWUKYXN5bmM6IG9wdGlvbmFs\
CnRhZ3M6CiAgLSBtb2JpbGUtc2VydmljZQogIC0gbW9iaWxlLWNsaWVudC1lbmFibGVkCm1ldGFk\
YXRhOgogIGRpc3BsYXlOYW1lOiBTeW5jIEFwcAogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25D\
bGFzczogZmEgZmEtcmVmcmVzaAogICNkb2N1bWVudGF0aW9uVXJsOiAiaHR0cHM6Ly9kb2NzLmFl\
cm9nZWFyLm9yZy9leHRlcm5hbC9hcGIvc3luYy1hcHAuaHRtbCIKICBwcm92aWRlckRpc3BsYXlO\
YW1lOiAiUmVkIEhhdCwgSW5jLiIKICBzZXJ2aWNlTmFtZTogc3luYy1hcHAKcGxhbnM6CiAgLSBu\
YW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBwbGFuIHNldHMgdXAgdGhlIFN5bmMg\
QXBwbGljYXRpb24KICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiAKICAgICAgbW9iaWxlY2xp\
ZW50X2JpbmRfcGFyYW1ldGVyc19kYXRhOgogICAgICAgIC0gJ3t9JwogICAgcGFyYW1ldGVyczoK\
ICAgICAgLSBuYW1lOiBTWU5DX0FQUF9OQU1FCiAgICAgICAgZGVzY3JpcHRpb246IFRoZSBuYW1l\
IG9mIHlvdXIgc3luYyBhcHBsaWNhdGlvbi4KICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBw\
YXR0ZXJuOiAiXlthLXpdW2EtejAtOV0qJCIKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAg\
IHRpdGxlOiBTeW5jIEFwcGxpY2F0aW9uIE5hbWUKICAgICAgLSBuYW1lOiBTWU5DX0FQUF9ET0NL\
RVJfSU1BR0UKICAgICAgICBkZXNjcmlwdGlvbjogVVJMIG9mIHlvdXIgU3luYyBBcHBsaWNhdGlv\
biBEb2NrZXIgSW1hZ2UsIGUuZy4gZG9ja2VyLmlvL2Flcm9nZWFyL3ZveWFnZXItc2VydmVyLWV4\
YW1wbGUtdGFzawogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAg\
ICAgICAgdGl0bGU6IFN5bmMgQXBwbGljYXRpb24gRG9ja2VyIGltYWdlCiAgICAgIC0gbmFtZTog\
U1lOQ19BUFBfRE9DS0VSX0lNQUdFX1ZFUlNJT04KICAgICAgICBkZXNjcmlwdGlvbjogVmVyc2lv\
biBvZiB5b3VyIFN5bmMgQXBwbGljYXRpb24gRG9ja2VyIEltYWdlICh1c2luZyAnbGF0ZXN0JyBp\
ZiBub3Qgc3BlY2lmaWVkKQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBG\
YWxzZQogICAgICAgIHRpdGxlOiBTeW5jIEFwcGxpY2F0aW9uIERvY2tlciBpbWFnZSB2ZXJzaW9u\
CiAgICAgIC0gbmFtZTogU1lOQ19BUFBfSEVBTFRIX0VORFBPSU5UCiAgICAgICAgZGVzY3JpcHRp\
b246IEhlYWx0aCBFbmRwb2ludCBvZiB5b3VyIFN5bmMgQXBwbGljYXRpb24gKHVzaW5nICcvJyBp\
ZiBub3Qgc3BlY2lmaWVkKQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBG\
YWxzZQogICAgICAgIHRpdGxlOiBTeW5jIEFwcGxpY2F0aW9uIGhlYWx0aCBlbmRwb2ludAogICAg\
ICAtIG5hbWU6IFNZTkNfQVBQX01FVFJJQ1NfRU5EUE9JTlQKICAgICAgICBkZXNjcmlwdGlvbjog\
TWV0cmljcyBlbmRwb2ludCBvZiB5b3VyIFN5bmMgQXBwbGljYXRpb24gKHVzaW5nICcvbWV0cmlj\
cycgaWYgbm90IHNwZWNpZmllZCkKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJl\
ZDogRmFsc2UKICAgICAgICB0aXRsZTogU3luYyBBcHBsaWNhdGlvbiBtZXRyaWNzIGVuZHBvaW50\
CiAgICAgICAgZGVmYXVsdDogJ21ldHJpY3MnCiAgICAgIC0gbmFtZTogU1lOQ19BUFBfUE9SVAog\
ICAgICAgIGRlc2NyaXB0aW9uOiBQb3J0IG9mIHRoZSBTeW5jIEFwcGxpY2F0aW9uIHRvIEV4cG9z\
ZQogICAgICAgIHR5cGU6IG51bWJlcgogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0\
bGU6IFN5bmMgQXBwIFBvcnQKICAgICAgLSBuYW1lOiBTWU5DX0FQUF9HUkFQSFFMX0VORFBPSU5U\
CiAgICAgICAgZGVzY3JpcHRpb246IEdyYXBoUUwgRW5kcG9pbnQgb2YgeW91ciBTeW5jIEFwcGxp\
Y2F0aW9uICh1c2luZyAnZ3JhcGhxbCcgaWYgbm90IHNwZWNpZmllZCkKICAgICAgICB0eXBlOiBz\
dHJpbmcKICAgICAgICByZXF1aXJlZDogRmFsc2UKICAgICAgICB0aXRsZTogU3luYyBBcHAgR3Jh\
cGhRTCBFbmRwb2ludAogICAgICAtIG5hbWU6IERCX0hPU1ROQU1FCiAgICAgICAgZGVzY3JpcHRp\
b246IEhvc3RuYW1lIG9mIHRoZSBTUUwgU2VydmVyCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAg\
ICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICB0aXRsZTogU1FMIFNlcnZlciBIb3N0bmFtZQogICAg\
ICAtIG5hbWU6IERCX1BPUlQKICAgICAgICBkZXNjcmlwdGlvbjogUG9ydCBvZiB0aGUgU1FMIFNl\
cnZlcgogICAgICAgIHR5cGU6IG51bWJlcgogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAg\
dGl0bGU6IFNRTCBTZXJ2ZXIgUG9ydAogICAgICAtIG5hbWU6IERCX1VTRVJOQU1FCiAgICAgICAg\
ZGVzY3JpcHRpb246IFVzZXJuYW1lIHRoYXQgd2lsbCBiZSB1c2VkIHRvIGNvbm5lY3QgdG8gRGF0\
YWJhc2UKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAg\
IHRpdGxlOiBTUUwgU2VydmVyIFVzZXJuYW1lCiAgICAgIC0gbmFtZTogREJfUEFTU1dPUkQKICAg\
ICAgICBkZXNjcmlwdGlvbjogUGFzc3dvcmQgdGhhdCB3aWxsIGJlIHVzZWQgdG8gY29ubmVjdCB0\
byBEYXRhYmFzZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAg\
ICAgICAgdGl0bGU6IFNRTCBTZXJ2ZXIgUGFzc3dvcmQKICAgICAgLSBuYW1lOiBEQl9OQU1FCiAg\
ICAgICAgZGVzY3JpcHRpb246IE5hbWUgb2YgdGhlIFNRTCBTZXJ2ZXIncyBkYXRhYmFzZQogICAg\
ICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IERh\
dGFiYXNlIG5hbWUKICAgICAgLSBuYW1lOiBEQl9TU0wKICAgICAgICBkZXNjcmlwdGlvbjogVXNl\
IFNTTCBjb25uZWN0aW9uIHRvIFNRTCBTZXJ2ZXIKICAgICAgICB0eXBlOiBib29sZWFuCiAgICAg\
ICAgZGlzcGxheV90eXBlOiBjaGVja2JveAogICAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICAgICAg\
dGl0bGU6IFVzZSBTU0w/CiAgICBiaW5kX3BhcmFtZXRlcnM6CiAgICAgIC0gbmFtZTogQ0xJRU5U\
X0lECiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICB0aXRsZTogTW9iaWxlIENsaWVudCBJ\
RAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIAo="

COPY playbooks /opt/apb/project
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
