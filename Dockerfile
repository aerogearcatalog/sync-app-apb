FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHN5bmMtYXBwLWFwYgpkZXNjcmlwdGlvbjogSW5zdGFsbHMgdGhl\
IEFlcm9nZWFyIFN5bmMgQXBwbGljYXRpb24KYmluZGFibGU6IFRydWUKYXN5bmM6IG9wdGlvbmFs\
CnRhZ3M6CiAgLSBtb2JpbGUtc2VydmljZQogIC0gbW9iaWxlLWNsaWVudC1lbmFibGVkCm1ldGFk\
YXRhOgogIGRpc3BsYXlOYW1lOiBTeW5jIEFwcAogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25D\
bGFzczogZmEgZmEtcmVmcmVzaAogICNkb2N1bWVudGF0aW9uVXJsOiAiaHR0cHM6Ly9kb2NzLmFl\
cm9nZWFyLm9yZy9hZXJvZ2Vhci9sYXRlc3QvZGF0YS1zeW5jLyIKICBwcm92aWRlckRpc3BsYXlO\
YW1lOiAiUmVkIEhhdCwgSW5jLiIKICBzZXJ2aWNlTmFtZTogc3luYy1hcHAKcGxhbnM6CiAgLSBu\
YW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBwbGFuIHNldHMgdXAgdGhlIFN5bmMg\
QXBwbGljYXRpb24KICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiAKICAgICAgbW9iaWxlY2xp\
ZW50X2JpbmRfcGFyYW1ldGVyc19kYXRhOgogICAgICAgIC0gJ3t9JwogICAgcGFyYW1ldGVyczoK\
ICAgICAgLSBuYW1lOiBTWU5DX0FQUF9OQU1FCiAgICAgICAgZGVzY3JpcHRpb246IFRoZSBuYW1l\
IG9mIHlvdXIgc3luYyBhcHBsaWNhdGlvbi4KICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBw\
YXR0ZXJuOiAiXlthLXpdW2EtejAtOS1dKlthLXowLTldJCIKICAgICAgICByZXF1aXJlZDogVHJ1\
ZQogICAgICAgIHRpdGxlOiBTeW5jIEFwcGxpY2F0aW9uIE5hbWUKICAgICAgLSBuYW1lOiBTWU5D\
X0FQUF9ET0NLRVJfSU1BR0UKICAgICAgICBkZXNjcmlwdGlvbjogVVJMIG9mIHlvdXIgR3JhcGhR\
TCBTZXJ2ZXIgRG9ja2VyIEltYWdlLCBlLmcuIGRvY2tlci5pby9hZXJvZ2Vhci92b3lhZ2VyLXNl\
cnZlci1leGFtcGxlLXRhc2sKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDog\
VHJ1ZQogICAgICAgIHRpdGxlOiBTeW5jIEFwcGxpY2F0aW9uIERvY2tlciBpbWFnZQogICAgICAt\
IG5hbWU6IFNZTkNfQVBQX0RPQ0tFUl9JTUFHRV9WRVJTSU9OCiAgICAgICAgZGVzY3JpcHRpb246\
IChkZWZhdWx0IHZhbHVlOiAnbGF0ZXN0JykgVmVyc2lvbiBvZiB5b3VyIFN5bmMgQXBwbGljYXRp\
b24gRG9ja2VyIEltYWdlCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IEZh\
bHNlCiAgICAgICAgdGl0bGU6IFN5bmMgQXBwbGljYXRpb24gRG9ja2VyIGltYWdlIHZlcnNpb24K\
ICAgICAgICBkZWZhdWx0OiAnbGF0ZXN0JwogICAgICAtIG5hbWU6IFNZTkNfQVBQX0hFQUxUSF9F\
TkRQT0lOVAogICAgICAgIGRlc2NyaXB0aW9uOiAoZGVmYXVsdCB2YWx1ZTogJy8nKSBIZWFsdGgg\
RW5kcG9pbnQgb2YgeW91ciBTeW5jIEFwcGxpY2F0aW9uLiBVc2UgJ2hlYWx0aCcgZm9yIGRvY2tl\
ci5pby9hZXJvZ2Vhci92b3lhZ2VyLXNlcnZlci1leGFtcGxlLXRhc2sgaW1hZ2UuCiAgICAgICAg\
dHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAgICAgdGl0bGU6IFN5bmMg\
QXBwbGljYXRpb24gaGVhbHRoIGVuZHBvaW50CiAgICAgIC0gbmFtZTogU1lOQ19BUFBfTUVUUklD\
U19FTkRQT0lOVAogICAgICAgIGRlc2NyaXB0aW9uOiAoZGVmYXVsdCB2YWx1ZTogJy9tZXRyaWNz\
JykgTWV0cmljcyBlbmRwb2ludCBvZiB5b3VyIFN5bmMgQXBwbGljYXRpb24KICAgICAgICB0eXBl\
OiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogRmFsc2UKICAgICAgICB0aXRsZTogU3luYyBBcHBs\
aWNhdGlvbiBtZXRyaWNzIGVuZHBvaW50CiAgICAgICAgZGVmYXVsdDogJ21ldHJpY3MnCiAgICAg\
IC0gbmFtZTogU1lOQ19BUFBfUE9SVAogICAgICAgIGRlc2NyaXB0aW9uOiBQb3J0IG9mIHRoZSBT\
eW5jIEFwcGxpY2F0aW9uIHRvIEV4cG9zZS4gVXNlICc0MDAwJyBmb3IgZG9ja2VyLmlvL2Flcm9n\
ZWFyL3ZveWFnZXItc2VydmVyLWV4YW1wbGUtdGFzayBpbWFnZS4KICAgICAgICB0eXBlOiBudW1i\
ZXIKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIHRpdGxlOiBTeW5jIEFwcCBQb3J0CiAg\
ICAgIC0gbmFtZTogU1lOQ19BUFBfR1JBUEhRTF9FTkRQT0lOVAogICAgICAgIGRlc2NyaXB0aW9u\
OiAoZGVmYXVsdCB2YWx1ZTogJ2dyYXBocWwnKSBHcmFwaFFMIEVuZHBvaW50IG9mIHlvdXIgU3lu\
YyBBcHBsaWNhdGlvbiAKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogRmFs\
c2UKICAgICAgICB0aXRsZTogU3luYyBBcHAgR3JhcGhRTCBFbmRwb2ludAogICAgICAtIG5hbWU6\
IERCX0hPU1ROQU1FCiAgICAgICAgZGVzY3JpcHRpb246IEhvc3RuYW1lIG9mIHRoZSBEYXRhYmFz\
ZSBTZXJ2ZXIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAg\
ICAgIHRpdGxlOiBEYXRhYmFzZSBTZXJ2ZXIgSG9zdG5hbWUKICAgICAgLSBuYW1lOiBEQl9QT1JU\
CiAgICAgICAgZGVzY3JpcHRpb246IFBvcnQgb2YgdGhlIERhdGFiYXNlIFNlcnZlcgogICAgICAg\
IHR5cGU6IG51bWJlcgogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IERhdGFi\
YXNlIFNlcnZlciBQb3J0CiAgICAgIC0gbmFtZTogREJfVVNFUk5BTUUKICAgICAgICBkZXNjcmlw\
dGlvbjogVXNlcm5hbWUgdGhhdCB3aWxsIGJlIHVzZWQgdG8gY29ubmVjdCB0byBEYXRhYmFzZQog\
ICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6\
IERhdGFiYXNlIFNlcnZlciBVc2VybmFtZQogICAgICAtIG5hbWU6IERCX1BBU1NXT1JECiAgICAg\
ICAgZGVzY3JpcHRpb246IFBhc3N3b3JkIHRoYXQgd2lsbCBiZSB1c2VkIHRvIGNvbm5lY3QgdG8g\
RGF0YWJhc2UKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAg\
ICAgIHRpdGxlOiBEYXRhYmFzZSBTZXJ2ZXIgUGFzc3dvcmQKICAgICAgLSBuYW1lOiBEQl9OQU1F\
CiAgICAgICAgZGVzY3JpcHRpb246IE5hbWUgb2YgdGhlIERhdGFiYXNlCiAgICAgICAgdHlwZTog\
c3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICB0aXRsZTogRGF0YWJhc2UgbmFt\
ZQogICAgICAtIG5hbWU6IERCX1NTTAogICAgICAgIGRlc2NyaXB0aW9uOiBVc2UgU1NMIGNvbm5l\
Y3Rpb24gdG8gdGhlIERhdGFiYXNlIFNlcnZlcgogICAgICAgIHR5cGU6IGJvb2xlYW4KICAgICAg\
ICBkaXNwbGF5X3R5cGU6IGNoZWNrYm94CiAgICAgICAgZGVmYXVsdDogZmFsc2UKICAgICAgICB0\
aXRsZTogVXNlIFNTTD8KICAgIGJpbmRfcGFyYW1ldGVyczoKICAgICAgLSBuYW1lOiBDTElFTlRf\
SUQKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIHRpdGxlOiBNb2JpbGUgQ2xpZW50IElE\
CiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgCg=="

COPY playbooks /opt/apb/project
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
