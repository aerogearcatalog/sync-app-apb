FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHN5bmMtYXBwLWFwYgpkZXNjcmlwdGlvbjogdjYgSW5zdGFsbHMg\
dGhlIEFlcm9nZWFyIFN5bmMgQXBwbGljYXRpb24KYmluZGFibGU6IFRydWUKYXN5bmM6IG9wdGlv\
bmFsCnRhZ3M6CiAgLSBtb2JpbGUtc2VydmljZQogIC0gbW9iaWxlLWNsaWVudC1lbmFibGVkCm1l\
dGFkYXRhOgogIGRpc3BsYXlOYW1lOiBTeW5jIEFwcAogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2lj\
b25DbGFzczogZmEgZmEtcmVmcmVzaAogICNkb2N1bWVudGF0aW9uVXJsOiAiaHR0cHM6Ly9kb2Nz\
LmFlcm9nZWFyLm9yZy9leHRlcm5hbC9hcGIvc3luYy1hcHAuaHRtbCIKICBwcm92aWRlckRpc3Bs\
YXlOYW1lOiAiUmVkIEhhdCwgSW5jLiIKICBzZXJ2aWNlTmFtZTogc3luYy1hcHAKcGxhbnM6CiAg\
LSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBwbGFuIHNldHMgdXAgdGhlIFN5\
bmMgQXBwbGljYXRpb24KICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFyYW1l\
dGVyczoKICAgICAgLSBuYW1lOiBTWU5DX0FQUF9ET0NLRVJfSU1BR0UKICAgICAgICBkZXNjcmlw\
dGlvbjogVVJMIG9mIHlvdXIgU3luYyBBcHBsaWNhdGlvbiBEb2NrZXIgSW1hZ2UsIGUuZy4gZG9j\
a2VyLmlvL2Flcm9nZWFyL3ZveWFnZXItc2VydmVyLWV4YW1wbGUtdGFzawogICAgICAgIHR5cGU6\
IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IFN5bmMgQXBwbGlj\
YXRpb24gRG9ja2VyIGltYWdlCiAgICAgIC0gbmFtZTogU1lOQ19BUFBfRE9DS0VSX0lNQUdFX1ZF\
UlNJT04KICAgICAgICBkZXNjcmlwdGlvbjogVmVyc2lvbiBvZiB5b3VyIFN5bmMgQXBwbGljYXRp\
b24gRG9ja2VyIEltYWdlICh1c2luZyAnbGF0ZXN0JyBpZiBub3Qgc3BlY2lmaWVkKQogICAgICAg\
IHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICAgIHRpdGxlOiBTeW5j\
IEFwcGxpY2F0aW9uIERvY2tlciBpbWFnZSB2ZXJzaW9uCiAgICAgIC0gbmFtZTogU1lOQ19BUFBf\
SEVBTFRIX0VORFBPSU5UCiAgICAgICAgZGVzY3JpcHRpb246IEhlYWx0aCBFbmRwb2ludCBvZiB5\
b3VyIFN5bmMgQXBwbGljYXRpb24gKHVzaW5nICcvJyBpZiBub3Qgc3BlY2lmaWVkKQogICAgICAg\
IHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICAgIHRpdGxlOiBTeW5j\
IEFwcGxpY2F0aW9uIGhlYWx0aCBlbmRwb2ludAogICAgICAtIG5hbWU6IFNZTkNfQVBQX1BPUlQK\
ICAgICAgICBkZXNjcmlwdGlvbjogUG9ydCBvZiB0aGUgU3luYyBBcHBsaWNhdGlvbiB0byBFeHBv\
c2UKICAgICAgICB0eXBlOiBudW1iZXIKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIHRp\
dGxlOiBTeW5jIEFwcCBQb3J0CiAgICAgIC0gbmFtZTogU1lOQ19BUFBfR1JBUEhRTF9FTkRQT0lO\
VAogICAgICAgIGRlc2NyaXB0aW9uOiBHcmFwaFFMIEVuZHBvaW50IG9mIHlvdXIgU3luYyBBcHBs\
aWNhdGlvbiAodXNpbmcgJ2dyYXBocWwnIGlmIG5vdCBzcGVjaWZpZWQpCiAgICAgICAgdHlwZTog\
c3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAgICAgdGl0bGU6IFN5bmMgQXBwIEdy\
YXBoUUwgRW5kcG9pbnQKICAgICAgLSBuYW1lOiBEQl9IT1NUTkFNRQogICAgICAgIGRlc2NyaXB0\
aW9uOiBIb3N0bmFtZSBvZiB0aGUgU1FMIFNlcnZlcgogICAgICAgIHR5cGU6IHN0cmluZwogICAg\
ICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IFNRTCBTZXJ2ZXIgSG9zdG5hbWUKICAg\
ICAgLSBuYW1lOiBEQl9QT1JUCiAgICAgICAgZGVzY3JpcHRpb246IFBvcnQgb2YgdGhlIFNRTCBT\
ZXJ2ZXIKICAgICAgICB0eXBlOiBudW1iZXIKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAg\
IHRpdGxlOiBTUUwgU2VydmVyIFBvcnQKICAgICAgLSBuYW1lOiBEQl9VU0VSTkFNRQogICAgICAg\
IGRlc2NyaXB0aW9uOiBVc2VybmFtZSB0aGF0IHdpbGwgYmUgdXNlZCB0byBjb25uZWN0IHRvIERh\
dGFiYXNlCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAg\
ICB0aXRsZTogU1FMIFNlcnZlciBVc2VybmFtZQogICAgICAtIG5hbWU6IERCX1BBU1NXT1JECiAg\
ICAgICAgZGVzY3JpcHRpb246IFBhc3N3b3JkIHRoYXQgd2lsbCBiZSB1c2VkIHRvIGNvbm5lY3Qg\
dG8gRGF0YWJhc2UKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogVHJ1ZQog\
ICAgICAgIHRpdGxlOiBTUUwgU2VydmVyIFBhc3N3b3JkCiAgICAgIC0gbmFtZTogREJfTkFNRQog\
ICAgICAgIGRlc2NyaXB0aW9uOiBOYW1lIG9mIHRoZSBTUUwgU2VydmVyJ3MgZGF0YWJhc2UKICAg\
ICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIHRpdGxlOiBE\
YXRhYmFzZSBuYW1lCiAgICAgIC0gbmFtZTogREJfU1NMCiAgICAgICAgZGVzY3JpcHRpb246IFVz\
ZSBTU0wgY29ubmVjdGlvbiB0byBTUUwgU2VydmVyCiAgICAgICAgdHlwZTogYm9vbGVhbgogICAg\
ICAgIGRpc3BsYXlfdHlwZTogY2hlY2tib3gKICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAgICAg\
IHRpdGxlOiBVc2UgU1NMPwogICAgYmluZF9wYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IENMSUVO\
VF9JRAogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IE1vYmlsZSBDbGllbnQg\
SUQKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICAK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
