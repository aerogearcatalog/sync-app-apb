FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHN5bmMtYXBwLWFwYgpkZXNjcmlwdGlvbjogSW5zdGFsbHMgdGhl\
IEFlcm9nZWFyIFN5bmMgQXBwbGljYXRpb24KYmluZGFibGU6IFRydWUKYXN5bmM6IG9wdGlvbmFs\
CnRhZ3M6CiAgLSBtb2JpbGUtc2VydmljZQogIC0gbW9iaWxlLWNsaWVudC1lbmFibGVkCm1ldGFk\
YXRhOgogIGRpc3BsYXlOYW1lOiBTeW5jIEFwcAogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25D\
bGFzczogZmEgZmEtcmVmcmVzaAogICNkb2N1bWVudGF0aW9uVXJsOiAiaHR0cHM6Ly9kb2NzLmFl\
cm9nZWFyLm9yZy9leHRlcm5hbC9hcGIvc3luYy1hcHAuaHRtbCIKICBwcm92aWRlckRpc3BsYXlO\
YW1lOiAiUmVkIEhhdCwgSW5jLiIKICBzZXJ2aWNlTmFtZTogc3luYy1hcHAKcGxhbnM6CiAgLSBu\
YW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBwbGFuIHNldHMgdXAgdGhlIFN5bmMg\
QXBwbGljYXRpb24KICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiAKICAgICAgbW9iaWxlY2xp\
ZW50X2JpbmRfcGFyYW1ldGVyc19kYXRhOgogICAgICAgIC0gJ3t9JwogICAgcGFyYW1ldGVyczoK\
ICAgICAgLSBuYW1lOiBTWU5DX0FQUF9OQU1FCiAgICAgICAgZGVzY3JpcHRpb246IFRoZSBuYW1l\
IG9mIHlvdXIgc3luYyBhcHBsaWNhdGlvbi4KICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBw\
YXR0ZXJuOiAiXlthLXpBLVpdW2EtekEtWjAtOV0qJCIKICAgICAgICByZXF1aXJlZDogVHJ1ZQog\
ICAgICAgIHRpdGxlOiBTeW5jIEFwcGxpY2F0aW9uIE5hbWUKICAgICAgLSBuYW1lOiBTWU5DX0FQ\
UF9ET0NLRVJfSU1BR0UKICAgICAgICBkZXNjcmlwdGlvbjogVVJMIG9mIHlvdXIgU3luYyBBcHBs\
aWNhdGlvbiBEb2NrZXIgSW1hZ2UsIGUuZy4gZG9ja2VyLmlvL2Flcm9nZWFyL3ZveWFnZXItc2Vy\
dmVyLWV4YW1wbGUtdGFzawogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBU\
cnVlCiAgICAgICAgdGl0bGU6IFN5bmMgQXBwbGljYXRpb24gRG9ja2VyIGltYWdlCiAgICAgIC0g\
bmFtZTogU1lOQ19BUFBfRE9DS0VSX0lNQUdFX1ZFUlNJT04KICAgICAgICBkZXNjcmlwdGlvbjog\
VmVyc2lvbiBvZiB5b3VyIFN5bmMgQXBwbGljYXRpb24gRG9ja2VyIEltYWdlICh1c2luZyAnbGF0\
ZXN0JyBpZiBub3Qgc3BlY2lmaWVkKQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVp\
cmVkOiBGYWxzZQogICAgICAgIHRpdGxlOiBTeW5jIEFwcGxpY2F0aW9uIERvY2tlciBpbWFnZSB2\
ZXJzaW9uCiAgICAgIC0gbmFtZTogU1lOQ19BUFBfSEVBTFRIX0VORFBPSU5UCiAgICAgICAgZGVz\
Y3JpcHRpb246IEhlYWx0aCBFbmRwb2ludCBvZiB5b3VyIFN5bmMgQXBwbGljYXRpb24gKHVzaW5n\
ICcvJyBpZiBub3Qgc3BlY2lmaWVkKQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVp\
cmVkOiBGYWxzZQogICAgICAgIHRpdGxlOiBTeW5jIEFwcGxpY2F0aW9uIGhlYWx0aCBlbmRwb2lu\
dAogICAgICAtIG5hbWU6IFNZTkNfQVBQX01FVFJJQ1NfRU5EUE9JTlQKICAgICAgICBkZXNjcmlw\
dGlvbjogTWV0cmljcyBlbmRwb2ludCBvZiB5b3VyIFN5bmMgQXBwbGljYXRpb24gKHVzaW5nICcv\
bWV0cmljcycgaWYgbm90IHNwZWNpZmllZCkKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBy\
ZXF1aXJlZDogRmFsc2UKICAgICAgICB0aXRsZTogU3luYyBBcHBsaWNhdGlvbiBtZXRyaWNzIGVu\
ZHBvaW50CiAgICAgICAgZGVmYXVsdDogJ21ldHJpY3MnCiAgICAgIC0gbmFtZTogU1lOQ19BUFBf\
UE9SVAogICAgICAgIGRlc2NyaXB0aW9uOiBQb3J0IG9mIHRoZSBTeW5jIEFwcGxpY2F0aW9uIHRv\
IEV4cG9zZQogICAgICAgIHR5cGU6IG51bWJlcgogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAg\
ICAgdGl0bGU6IFN5bmMgQXBwIFBvcnQKICAgICAgLSBuYW1lOiBTWU5DX0FQUF9HUkFQSFFMX0VO\
RFBPSU5UCiAgICAgICAgZGVzY3JpcHRpb246IEdyYXBoUUwgRW5kcG9pbnQgb2YgeW91ciBTeW5j\
IEFwcGxpY2F0aW9uICh1c2luZyAnZ3JhcGhxbCcgaWYgbm90IHNwZWNpZmllZCkKICAgICAgICB0\
eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogRmFsc2UKICAgICAgICB0aXRsZTogU3luYyBB\
cHAgR3JhcGhRTCBFbmRwb2ludAogICAgICAtIG5hbWU6IERCX0hPU1ROQU1FCiAgICAgICAgZGVz\
Y3JpcHRpb246IEhvc3RuYW1lIG9mIHRoZSBTUUwgU2VydmVyCiAgICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICB0aXRsZTogU1FMIFNlcnZlciBIb3N0bmFt\
ZQogICAgICAtIG5hbWU6IERCX1BPUlQKICAgICAgICBkZXNjcmlwdGlvbjogUG9ydCBvZiB0aGUg\
U1FMIFNlcnZlcgogICAgICAgIHR5cGU6IG51bWJlcgogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAg\
ICAgICAgdGl0bGU6IFNRTCBTZXJ2ZXIgUG9ydAogICAgICAtIG5hbWU6IERCX1VTRVJOQU1FCiAg\
ICAgICAgZGVzY3JpcHRpb246IFVzZXJuYW1lIHRoYXQgd2lsbCBiZSB1c2VkIHRvIGNvbm5lY3Qg\
dG8gRGF0YWJhc2UKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogVHJ1ZQog\
ICAgICAgIHRpdGxlOiBTUUwgU2VydmVyIFVzZXJuYW1lCiAgICAgIC0gbmFtZTogREJfUEFTU1dP\
UkQKICAgICAgICBkZXNjcmlwdGlvbjogUGFzc3dvcmQgdGhhdCB3aWxsIGJlIHVzZWQgdG8gY29u\
bmVjdCB0byBEYXRhYmFzZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBU\
cnVlCiAgICAgICAgdGl0bGU6IFNRTCBTZXJ2ZXIgUGFzc3dvcmQKICAgICAgLSBuYW1lOiBEQl9O\
QU1FCiAgICAgICAgZGVzY3JpcHRpb246IE5hbWUgb2YgdGhlIFNRTCBTZXJ2ZXIncyBkYXRhYmFz\
ZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0\
bGU6IERhdGFiYXNlIG5hbWUKICAgICAgLSBuYW1lOiBEQl9TU0wKICAgICAgICBkZXNjcmlwdGlv\
bjogVXNlIFNTTCBjb25uZWN0aW9uIHRvIFNRTCBTZXJ2ZXIKICAgICAgICB0eXBlOiBib29sZWFu\
CiAgICAgICAgZGlzcGxheV90eXBlOiBjaGVja2JveAogICAgICAgIGRlZmF1bHQ6IGZhbHNlCiAg\
ICAgICAgdGl0bGU6IFVzZSBTU0w/CiAgICBiaW5kX3BhcmFtZXRlcnM6CiAgICAgIC0gbmFtZTog\
Q0xJRU5UX0lECiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICB0aXRsZTogTW9iaWxlIENs\
aWVudCBJRAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIAo="

COPY playbooks /opt/apb/project
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
