FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHN5bmMtYXBwLWFwYgpkZXNjcmlwdGlvbjogSW5zdGFsbHMgdGhl\
IEFlcm9nZWFyIFN5bmMgQXBwbGljYXRpb24KYmluZGFibGU6IFRydWUKYXN5bmM6IG9wdGlvbmFs\
CnRhZ3M6CiAgLSBtb2JpbGUtc2VydmljZQogIC0gbW9iaWxlLWNsaWVudC1lbmFibGVkCm1ldGFk\
YXRhOgogIGRpc3BsYXlOYW1lOiBTeW5jIEFwcAogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25D\
bGFzczogZmEgZmEtcmVmcmVzaAogICNkb2N1bWVudGF0aW9uVXJsOiAiaHR0cHM6Ly9kb2NzLmFl\
cm9nZWFyLm9yZy9hZXJvZ2Vhci9sYXRlc3QvZGF0YS1zeW5jLyIKICBwcm92aWRlckRpc3BsYXlO\
YW1lOiAiUmVkIEhhdCwgSW5jLiIKICBzZXJ2aWNlTmFtZTogc3luYy1hcHAKcGxhbnM6CiAgLSBu\
YW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBwbGFuIHNldHMgdXAgdGhlIFN5bmMg\
QXBwbGljYXRpb24KICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiAKICAgICAgbW9iaWxlY2xp\
ZW50X2JpbmRfcGFyYW1ldGVyc19kYXRhOgogICAgICAgIC0gJ3t9JwogICAgcGFyYW1ldGVyczoK\
ICAgICAgLSBuYW1lOiBTWU5DX0FQUF9OQU1FCiAgICAgICAgZGVzY3JpcHRpb246IFRoZSBuYW1l\
IG9mIHlvdXIgc3luYyBhcHBsaWNhdGlvbi4KICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBw\
YXR0ZXJuOiAiXlthLXpdW2EtejAtOS1dKlthLXowLTldJCIKICAgICAgICByZXF1aXJlZDogVHJ1\
ZQogICAgICAgIHRpdGxlOiBTeW5jIEFwcGxpY2F0aW9uIE5hbWUKICAgICAgLSBuYW1lOiBTWU5D\
X0FQUF9ET0NLRVJfSU1BR0UKICAgICAgICBkZXNjcmlwdGlvbjogVVJMIG9mIHlvdXIgR3JhcGhR\
TCBTZXJ2ZXIgRG9ja2VyIEltYWdlLCBlLmcuIGRvY2tlci5pby9hZXJvZ2Vhci92b3lhZ2VyLXNl\
cnZlci1leGFtcGxlLXRhc2sKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDog\
VHJ1ZQogICAgICAgIHRpdGxlOiBTeW5jIEFwcGxpY2F0aW9uIERvY2tlciBpbWFnZQogICAgICAt\
IG5hbWU6IFNZTkNfQVBQX0RPQ0tFUl9JTUFHRV9WRVJTSU9OCiAgICAgICAgZGVzY3JpcHRpb246\
ICIoZGVmYXVsdCB2YWx1ZTogJ2xhdGVzdCcpIFZlcnNpb24gb2YgeW91ciBTeW5jIEFwcGxpY2F0\
aW9uIERvY2tlciBJbWFnZSIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDog\
RmFsc2UKICAgICAgICB0aXRsZTogU3luYyBBcHBsaWNhdGlvbiBEb2NrZXIgaW1hZ2UgdmVyc2lv\
bgogICAgICAgIGRlZmF1bHQ6ICdsYXRlc3QnCiAgICAgIC0gbmFtZTogU1lOQ19BUFBfSEVBTFRI\
X0VORFBPSU5UCiAgICAgICAgZGVzY3JpcHRpb246ICIoZGVmYXVsdCB2YWx1ZTogJycpIEhlYWx0\
aCBFbmRwb2ludCBvZiB5b3VyIFN5bmMgQXBwbGljYXRpb24uIFVzZSAnaGVhbHRoJyBmb3IgZG9j\
a2VyLmlvL2Flcm9nZWFyL3ZveWFnZXItc2VydmVyLWV4YW1wbGUtdGFzayBpbWFnZS4iCiAgICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAgICAgdGl0bGU6IFN5\
bmMgQXBwbGljYXRpb24gaGVhbHRoIGVuZHBvaW50CiAgICAgIC0gbmFtZTogU1lOQ19BUFBfTUVU\
UklDU19FTkRQT0lOVAogICAgICAgIGRlc2NyaXB0aW9uOiAiKGRlZmF1bHQgdmFsdWU6ICcvbWV0\
cmljcycpIE1ldHJpY3MgZW5kcG9pbnQgb2YgeW91ciBTeW5jIEFwcGxpY2F0aW9uIgogICAgICAg\
IHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICAgIHRpdGxlOiBTeW5j\
IEFwcGxpY2F0aW9uIG1ldHJpY3MgZW5kcG9pbnQKICAgICAgICBkZWZhdWx0OiAnbWV0cmljcycK\
ICAgICAgLSBuYW1lOiBTWU5DX0FQUF9QT1JUCiAgICAgICAgZGVzY3JpcHRpb246IFBvcnQgb2Yg\
dGhlIFN5bmMgQXBwbGljYXRpb24gdG8gRXhwb3NlLiBVc2UgJzQwMDAnIGZvciBkb2NrZXIuaW8v\
YWVyb2dlYXIvdm95YWdlci1zZXJ2ZXItZXhhbXBsZS10YXNrIGltYWdlLgogICAgICAgIHR5cGU6\
IG51bWJlcgogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IFN5bmMgQXBwIFBv\
cnQKICAgICAgLSBuYW1lOiBTWU5DX0FQUF9HUkFQSFFMX0VORFBPSU5UCiAgICAgICAgZGVzY3Jp\
cHRpb246ICIoZGVmYXVsdCB2YWx1ZTogJ2dyYXBocWwnKSBHcmFwaFFMIEVuZHBvaW50IG9mIHlv\
dXIgU3luYyBBcHBsaWNhdGlvbiIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJl\
ZDogRmFsc2UKICAgICAgICB0aXRsZTogU3luYyBBcHAgR3JhcGhRTCBFbmRwb2ludAogICAgICAt\
IG5hbWU6IERCX0hPU1ROQU1FCiAgICAgICAgZGVzY3JpcHRpb246IEhvc3RuYW1lIG9mIHRoZSBE\
YXRhYmFzZSBTZXJ2ZXIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogVHJ1\
ZQogICAgICAgIHRpdGxlOiBEYXRhYmFzZSBTZXJ2ZXIgSG9zdG5hbWUKICAgICAgLSBuYW1lOiBE\
Ql9QT1JUCiAgICAgICAgZGVzY3JpcHRpb246IFBvcnQgb2YgdGhlIERhdGFiYXNlIFNlcnZlcgog\
ICAgICAgIHR5cGU6IG51bWJlcgogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6\
IERhdGFiYXNlIFNlcnZlciBQb3J0CiAgICAgIC0gbmFtZTogREJfVVNFUk5BTUUKICAgICAgICBk\
ZXNjcmlwdGlvbjogVXNlcm5hbWUgdGhhdCB3aWxsIGJlIHVzZWQgdG8gY29ubmVjdCB0byBEYXRh\
YmFzZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAg\
dGl0bGU6IERhdGFiYXNlIFNlcnZlciBVc2VybmFtZQogICAgICAtIG5hbWU6IERCX1BBU1NXT1JE\
CiAgICAgICAgZGVzY3JpcHRpb246IFBhc3N3b3JkIHRoYXQgd2lsbCBiZSB1c2VkIHRvIGNvbm5l\
Y3QgdG8gRGF0YWJhc2UKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogVHJ1\
ZQogICAgICAgIHRpdGxlOiBEYXRhYmFzZSBTZXJ2ZXIgUGFzc3dvcmQKICAgICAgLSBuYW1lOiBE\
Ql9OQU1FCiAgICAgICAgZGVzY3JpcHRpb246IE5hbWUgb2YgdGhlIERhdGFiYXNlCiAgICAgICAg\
dHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICB0aXRsZTogRGF0YWJh\
c2UgbmFtZQogICAgICAtIG5hbWU6IERCX1NTTAogICAgICAgIGRlc2NyaXB0aW9uOiBVc2UgU1NM\
IGNvbm5lY3Rpb24gdG8gdGhlIERhdGFiYXNlIFNlcnZlcgogICAgICAgIHR5cGU6IGJvb2xlYW4K\
ICAgICAgICBkaXNwbGF5X3R5cGU6IGNoZWNrYm94CiAgICAgICAgZGVmYXVsdDogZmFsc2UKICAg\
ICAgICB0aXRsZTogVXNlIFNTTD8KICAgIGJpbmRfcGFyYW1ldGVyczoKICAgICAgLSBuYW1lOiBD\
TElFTlRfSUQKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIHRpdGxlOiBNb2JpbGUgQ2xp\
ZW50IElECiAgICAgICAgdHlwZTogc3RyaW5n"

COPY playbooks /opt/apb/project
COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
