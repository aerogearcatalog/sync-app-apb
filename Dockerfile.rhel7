FROM openshift3/apb-base:v3.11

LABEL com.redhat.component="mobile-sync-app-apb" \
      com.redhat.apb.spec=\
"dmVyc2lvbjogMS4wCm5hbWU6IHN5bmMtYXBwLWFwYgpkZXNjcmlwdGlvbjogSW5zdGFsbHMgdGhl\
IEFlcm9nZWFyIFN5bmMgQXBwbGljYXRpb24KYmluZGFibGU6IFRydWUKYXN5bmM6IG9wdGlvbmFs\
CnRhZ3M6CiAgLSBtb2JpbGUtc2VydmljZQogIC0gbW9iaWxlLWNsaWVudC1lbmFibGVkCm1ldGFk\
YXRhOgogIGRpc3BsYXlOYW1lOiBTeW5jIEFwcAogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25D\
bGFzczogZmEgZmEtcmVmcmVzaAogICNkb2N1bWVudGF0aW9uVXJsOiAiaHR0cHM6Ly9kb2NzLmFl\
cm9nZWFyLm9yZy9leHRlcm5hbC9hcGIvc3luYy1hcHAuaHRtbCIKICBwcm92aWRlckRpc3BsYXlO\
YW1lOiAiUmVkIEhhdCwgSW5jLiIKICBzZXJ2aWNlTmFtZTogc3luYy1hcHAKcGxhbnM6CiAgLSBu\
YW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBwbGFuIHNldHMgdXAgdGhlIFN5bmMg\
QXBwbGljYXRpb24KICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiAKICAgICAgbW9iaWxlY2xp\
ZW50X2JpbmRfcGFyYW1ldGVyc19kYXRhOgogICAgICAgIC0gJ3t9JwogICAgcGFyYW1ldGVyczoK\
ICAgICAgLSBuYW1lOiBTWU5DX0FQUF9OQU1FCiAgICAgICAgZGVzY3JpcHRpb246IFRoZSBuYW1l\
IG9mIHlvdXIgc3luYyBhcHBsaWNhdGlvbi4KICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBw\
YXR0ZXJuOiAiXlthLXpdW2EtejAtOS1dKlthLXowLTldJCIKICAgICAgICByZXF1aXJlZDogVHJ1\
ZQogICAgICAgIHRpdGxlOiBTeW5jIEFwcGxpY2F0aW9uIE5hbWUKICAgICAgLSBuYW1lOiBTWU5D\
X0FQUF9ET0NLRVJfSU1BR0UKICAgICAgICBkZXNjcmlwdGlvbjogVVJMIG9mIHlvdXIgU3luYyBB\
cHBsaWNhdGlvbiBEb2NrZXIgSW1hZ2UsIGUuZy4gZG9ja2VyLmlvL2Flcm9nZWFyL3ZveWFnZXIt\
c2VydmVyLWV4YW1wbGUtdGFzawogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVk\
OiBUcnVlCiAgICAgICAgdGl0bGU6IFN5bmMgQXBwbGljYXRpb24gRG9ja2VyIGltYWdlCiAgICAg\
IC0gbmFtZTogU1lOQ19BUFBfRE9DS0VSX0lNQUdFX1ZFUlNJT04KICAgICAgICBkZXNjcmlwdGlv\
bjogVmVyc2lvbiBvZiB5b3VyIFN5bmMgQXBwbGljYXRpb24gRG9ja2VyIEltYWdlICh1c2luZyAn\
bGF0ZXN0JyBpZiBub3Qgc3BlY2lmaWVkKQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJl\
cXVpcmVkOiBGYWxzZQogICAgICAgIHRpdGxlOiBTeW5jIEFwcGxpY2F0aW9uIERvY2tlciBpbWFn\
ZSB2ZXJzaW9uCiAgICAgIC0gbmFtZTogU1lOQ19BUFBfSEVBTFRIX0VORFBPSU5UCiAgICAgICAg\
ZGVzY3JpcHRpb246IEhlYWx0aCBFbmRwb2ludCBvZiB5b3VyIFN5bmMgQXBwbGljYXRpb24gKHVz\
aW5nICcvJyBpZiBub3Qgc3BlY2lmaWVkKQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJl\
cXVpcmVkOiBGYWxzZQogICAgICAgIHRpdGxlOiBTeW5jIEFwcGxpY2F0aW9uIGhlYWx0aCBlbmRw\
b2ludAogICAgICAtIG5hbWU6IFNZTkNfQVBQX01FVFJJQ1NfRU5EUE9JTlQKICAgICAgICBkZXNj\
cmlwdGlvbjogTWV0cmljcyBlbmRwb2ludCBvZiB5b3VyIFN5bmMgQXBwbGljYXRpb24gKHVzaW5n\
ICcvbWV0cmljcycgaWYgbm90IHNwZWNpZmllZCkKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAg\
ICByZXF1aXJlZDogRmFsc2UKICAgICAgICB0aXRsZTogU3luYyBBcHBsaWNhdGlvbiBtZXRyaWNz\
IGVuZHBvaW50CiAgICAgICAgZGVmYXVsdDogJ21ldHJpY3MnCiAgICAgIC0gbmFtZTogU1lOQ19B\
UFBfUE9SVAogICAgICAgIGRlc2NyaXB0aW9uOiBQb3J0IG9mIHRoZSBTeW5jIEFwcGxpY2F0aW9u\
IHRvIEV4cG9zZQogICAgICAgIHR5cGU6IG51bWJlcgogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAg\
ICAgICAgdGl0bGU6IFN5bmMgQXBwIFBvcnQKICAgICAgLSBuYW1lOiBTWU5DX0FQUF9HUkFQSFFM\
X0VORFBPSU5UCiAgICAgICAgZGVzY3JpcHRpb246IEdyYXBoUUwgRW5kcG9pbnQgb2YgeW91ciBT\
eW5jIEFwcGxpY2F0aW9uICh1c2luZyAnZ3JhcGhxbCcgaWYgbm90IHNwZWNpZmllZCkKICAgICAg\
ICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogRmFsc2UKICAgICAgICB0aXRsZTogU3lu\
YyBBcHAgR3JhcGhRTCBFbmRwb2ludAogICAgICAtIG5hbWU6IERCX0hPU1ROQU1FCiAgICAgICAg\
ZGVzY3JpcHRpb246IEhvc3RuYW1lIG9mIHRoZSBTUUwgU2VydmVyCiAgICAgICAgdHlwZTogc3Ry\
aW5nCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICB0aXRsZTogU1FMIFNlcnZlciBIb3N0\
bmFtZQogICAgICAtIG5hbWU6IERCX1BPUlQKICAgICAgICBkZXNjcmlwdGlvbjogUG9ydCBvZiB0\
aGUgU1FMIFNlcnZlcgogICAgICAgIHR5cGU6IG51bWJlcgogICAgICAgIHJlcXVpcmVkOiBUcnVl\
CiAgICAgICAgdGl0bGU6IFNRTCBTZXJ2ZXIgUG9ydAogICAgICAtIG5hbWU6IERCX1VTRVJOQU1F\
CiAgICAgICAgZGVzY3JpcHRpb246IFVzZXJuYW1lIHRoYXQgd2lsbCBiZSB1c2VkIHRvIGNvbm5l\
Y3QgdG8gRGF0YWJhc2UKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogVHJ1\
ZQogICAgICAgIHRpdGxlOiBTUUwgU2VydmVyIFVzZXJuYW1lCiAgICAgIC0gbmFtZTogREJfUEFT\
U1dPUkQKICAgICAgICBkZXNjcmlwdGlvbjogUGFzc3dvcmQgdGhhdCB3aWxsIGJlIHVzZWQgdG8g\
Y29ubmVjdCB0byBEYXRhYmFzZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVk\
OiBUcnVlCiAgICAgICAgdGl0bGU6IFNRTCBTZXJ2ZXIgUGFzc3dvcmQKICAgICAgLSBuYW1lOiBE\
Ql9OQU1FCiAgICAgICAgZGVzY3JpcHRpb246IE5hbWUgb2YgdGhlIFNRTCBTZXJ2ZXIncyBkYXRh\
YmFzZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAg\
dGl0bGU6IERhdGFiYXNlIG5hbWUKICAgICAgLSBuYW1lOiBEQl9TU0wKICAgICAgICBkZXNjcmlw\
dGlvbjogVXNlIFNTTCBjb25uZWN0aW9uIHRvIFNRTCBTZXJ2ZXIKICAgICAgICB0eXBlOiBib29s\
ZWFuCiAgICAgICAgZGlzcGxheV90eXBlOiBjaGVja2JveAogICAgICAgIGRlZmF1bHQ6IGZhbHNl\
CiAgICAgICAgdGl0bGU6IFVzZSBTU0w/CiAgICBiaW5kX3BhcmFtZXRlcnM6CiAgICAgIC0gbmFt\
ZTogQ0xJRU5UX0lECiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICB0aXRsZTogTW9iaWxl\
IENsaWVudCBJRAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIAo=" \
      name="mobile/mobile-sync-app-apb" \
      io.k8s.display-name="Mobile Sync App APB" \
      io.k8s.description="An APB that deploys a Sync app on OpenShift through the service catalog, and provides a binding action for mobile use cases" \
      description="An APB that deploys a Sync app on OpenShift through the service catalog, and provides a binding action for mobile use cases" \
      summary="An APB that deploys a Sync app on OpenShift through the service catalog, and provides a binding action for mobile use cases" \
      usage="An APB that deploys a Sync app on OpenShift through the service catalog, and provides a binding action for mobile use cases" \
      maintainer="Red Hat Mobile team" \
      version="1.0.0"

COPY playbooks /opt/apb/project
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
